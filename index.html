<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora Dual Pro - Ergonomic Edition</title>
    <style>
        :root {
            --bg: #121212;
            --panel: #2d2d2d;
            --accent: #f2a154; 
            --blue: #5183b4;   
            --green: #539d67;  
            --text: #ffffff;
            --btn-std: #d1d1d1;
            --btn-sci: #4a4a4a;
        }

        body {
            font-family: 'Segoe UI', sans-serif;
            background: #000;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .calculator {
            background: var(--panel);
            width: 440px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.6);
        }

        #std-display {
            background: #222;
            height: 100px;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            justify-content: center;
            padding: 0 25px;
            font-size: 2.5rem;
            color: white;
            border-bottom: 2px solid #111;
        }

        .memory-indicator { font-size: 0.9rem; color: var(--accent); height: 20px; font-weight: bold; }

        .prog-screens { display: none; flex-direction: column; border-bottom: 1px solid #444; }
        .base-row {
            display: flex; padding: 6px 15px;
            justify-content: space-between; align-items: center;
        }
        .base-label { font-weight: bold; width: 50px; font-size: 0.75rem; color: #aaa; }
        .base-val { font-family: 'Courier New', monospace; font-size: 1rem; color: #eee; }

        .tabs { display: flex; background: #333; }
        .tab { 
            flex: 1; padding: 14px; border: none; background: transparent; 
            color: #888; cursor: pointer; font-weight: bold; font-size: 0.8rem;
        }
        .tab.active { color: var(--accent); background: var(--panel); }

        /* ESTRUCTURA DE LA REJILLA */
        .main-layout { display: flex; background: #444; gap: 1px; }

        .hex-sidebar {
            display: none; flex-direction: column;
            width: 70px; gap: 1px;
        }

        .num-pad {
            flex: 1; display: grid;
            /* 5 columnas: 4 para funciones/números + 1 para operadores principales */
            grid-template-columns: repeat(4, 1fr) 1.1fr;
            gap: 1px;
        }

        button {
            border: none; background: var(--btn-std);
            color: #000; padding: 18px 5px;
            font-size: 1.1rem; cursor: pointer;
            font-weight: 600;
        }
        button:hover { filter: brightness(1.1); }
        button:active { filter: brightness(0.8); }
        
        .btn-op { background: var(--blue); color: white; font-size: 1.4rem; }
        .btn-orange { background: var(--accent); color: white; }
        .btn-sci { background: var(--btn-sci); color: white; font-size: 0.85rem; }
        .btn-hex { background: #555; color: white; flex: 1; }
        
        .prog-active .hex-sidebar { display: flex; }
        .prog-active .prog-screens { display: flex; }

        /* Estilo especial para el igual vertical */
        .btn-equal { grid-row: span 2; background: var(--accent); color: white; }
    </style>
</head>
<body>

<div class="calculator" id="calc">
    <div class="tabs">
        <button class="tab active" id="t-std" onclick="setMode('std')">ESTÁNDAR</button>
        <button class="tab" id="t-prog" onclick="setMode('prog')">PROGRAMADOR</button>
    </div>

    <div class="prog-screens">
        <div class="base-row" style="background: rgba(81, 131, 180, 0.2)"><span class="base-label">HEX</span><span id="h-v" class="base-val">0</span></div>
        <div class="base-row" style="background: rgba(83, 157, 103, 0.2)"><span class="base-label">DEC</span><span id="d-v" class="base-val">0</span></div>
        <div class="base-row" style="background: rgba(0, 0, 0, 0.3)"><span class="base-label">BIN</span><span id="b-v" class="base-val">0000 0000</span></div>
    </div>

    <div id="std-display">
        <div class="memory-indicator" id="mem-inc"></div>
        <div id="main-val">0</div>
    </div>

    <div class="main-layout">
        <div class="hex-sidebar">
            <button class="btn-hex" onclick="add('A')">A</button>
            <button class="btn-hex" onclick="add('B')">B</button>
            <button class="btn-hex" onclick="add('C')">C</button>
            <button class="btn-hex" onclick="add('D')">D</button>
            <button class="btn-hex" onclick="add('E')">E</button>
            <button class="btn-hex" onclick="add('F')">F</button>
        </div>

        <div class="num-pad">
            <button class="btn-sci" onclick="add('Math.sin(')">sin</button>
            <button class="btn-sci" onclick="add('Math.cos(')">cos</button>
            <button class="btn-sci" onclick="add('(')">(</button>
            <button class="btn-sci" onclick="add(')')">)</button>
            <button class="btn-orange" onclick="clearAll()">AC</button>

            <button class="btn-sci" onclick="add('Math.log(')">ln</button>
            <button class="btn-sci" onclick="add('Math.log10(')">log</button>
            <button class="btn-sci" onclick="memOp('MR')">MR</button>
            <button class="btn-orange" onclick="del()">DEL</button>
            <button class="btn-op" onclick="add('/')">÷</button>

            <button onclick="add('7')">7</button>
            <button onclick="add('8')">8</button>
            <button onclick="add('9')">9</button>
            <button class="btn-sci" onclick="memOp('M+')">M+</button>
            <button class="btn-op" onclick="add('*')">×</button>

            <button onclick="add('4')">4</button>
            <button onclick="add('5')">5</button>
            <button onclick="add('6')">6</button>
            <button class="btn-sci" onclick="memOp('M-')">M-</button>
            <button class="btn-op" onclick="add('-')">−</button>

            <button onclick="add('1')">1</button>
            <button onclick="add('2')">2</button>
            <button onclick="add('3')">3</button>
            <button class="btn-sci" onclick="add('Math.PI')">π</button>
            <button class="btn-op" onclick="add('+')">+</button>

            <button onclick="add('0')" style="grid-column: span 2;">0</button>
            <button onclick="add('.')">.</button>
            <button class="btn-sci" onclick="memOp('MC')">MC</button>
            <button class="btn-equal" onclick="solve()">=</button>
        </div>
    </div>
</div>

<script>
    let val = "0";
    let memory = 0;
    let isProg = false;

    function setMode(m) {
        isProg = (m === 'prog');
        document.getElementById('calc').className = isProg ? 'calculator prog-active' : 'calculator';
        document.getElementById('t-std').classList.toggle('active', !isProg);
        document.getElementById('t-prog').classList.toggle('active', isProg);
        update();
    }

    function add(v) {
        if (val === "0" && !v.includes('Math') && v !== '.') val = v;
        else val += v;
        update();
    }

    function clearAll() { val = "0"; update(); }
    function del() { val = val.length > 1 ? val.slice(0, -1) : "0"; update(); }

    function memOp(op) {
        let current = parseFloat(eval(val.replace(/×/g, '*').replace(/÷/g, '/'))) || 0;
        switch(op) {
            case 'MC': memory = 0; break;
            case 'MR': val = memory.toString(); break;
            case 'M+': memory += current; break;
            case 'M-': memory -= current; break;
        }
        document.getElementById('mem-inc').innerText = memory !== 0 ? "MEMORY ACTIVE" : "";
        update();
    }

    function update() {
        let displayStr = val.replace(/Math\./g, '').replace(/\(/g, '(');
        document.getElementById('main-val').innerText = displayStr;

        if(isProg) {
            let n = parseInt(val.match(/\d+/g)?.pop() || 0, 10);
            document.getElementById('h-v').innerText = n.toString(16).toUpperCase();
            document.getElementById('d-v').innerText = n.toString(10);
            document.getElementById('b-v').innerText = n.toString(2).padStart(8, '0').replace(/(.{4})/g, '$1 ');
        }
    }

    function solve() {
        try {
            let openP = (val.match(/\(/g) || []).length;
            let closeP = (val.match(/\)/g) || []).length;
            while(openP > closeP) { val += ')'; closeP++; }

            let cleanExp = val.replace(/×/g, '*').replace(/÷/g, '/');
            let res = eval(cleanExp);
            val = Number(res.toPrecision(10)).toString();
            update();
        } catch {
            val = "Error"; update(); setTimeout(clearAll, 1000);
        }
    }
</script>
</body>
</html>
